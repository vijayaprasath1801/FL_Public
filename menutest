import React from "react";
import { render, fireEvent, screen } from "@testing-library/react";
import ActionButtons from "../ActionButtons";  // Adjust the path accordingly

describe("ActionButtons", () => {
  const mockOnActionClick = jest.fn();

  const mockItem = {
    payment: {
      sCount: 1,
    },
  };

  const renderComponent = (status, pageType, disabled = false) => {
    render(
      <ActionButtons
        status={status}
        onActionClick={mockOnActionClick}
        disabled={disabled}
        item={mockItem}
        pageType={pageType}
      />
    );
  };

  beforeEach(() => {
    mockOnActionClick.mockClear();
  });

   it("renders correct actions based on status and pageType", () => {
    renderComponent("PAUSED", "testRun");
    const actionsButton = screen.getByRole("button", { name: /Actions/i });
    
    fireEvent.click(actionsButton);
    
    expect(screen.getByRole("menuitem", { name: /Resume/i })).toBeInTheDocument();
    expect(screen.queryByText("Cancel")).toBeNull();
    
    renderComponent("STARTED", "testRun");
    fireEvent.click(actionsButton);
    
    expect(screen.getByRole("menuitem", { name: /Pause/i })).toBeInTheDocument();
    
    renderComponent("COMPLETED", "testRun");
    fireEvent.click(actionsButton);
    
    expect(screen.getByRole("menuitem", { name: /Re-Run/i })).toBeInTheDocument();
    
    renderComponent("COMPLETED", "payments");
    fireEvent.click(actionsButton);
    
    expect(screen.getByRole("menuitem", { name: /Schedule a run/i })).toBeInTheDocument();
  });

  it("does not render actions when disabled", () => {
    renderComponent("PAUSED", "testRun", true);
    
    fireEvent.click(screen.getByRole("button", { name: /Actions/i }));
    
    expect(screen.queryByText("Resume")).toBeNull();
  });

  it("calls onActionClick when an action is selected", () => {
    renderComponent("STARTED", "testRun");
    
    fireEvent.click(screen.getByRole("button", { name: /Actions/i }));
    
    fireEvent.click(screen.getByRole("menuitem", { name: /Pause/i }));
    
    expect(mockOnActionClick).toHaveBeenCalledWith("pause", mockItem);
  });
});
